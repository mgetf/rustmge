<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>mge.tf</title>
    <script src="//unpkg.com/alpinejs" defer></script>
    <script src="//unpkg.com/axios"></script>
  </head>

  <body>
    <h1>mge.tf</h1>
    <div x-data="servers_req">
        <template x-if="data">
            <table>
                <template x-for="server in data">
                    <tr x-data="server">
                      <td x-text="players"></td>
                      <td x-text="name"></td>
                      <td><a :href="'steam://connect/' + ip">Connect</a></td>
                    </tr>
                </template>
            </ul>
        </template>
    </div>
    <div x-data="players_req">
        <template x-if="data">
            tracking x players
        </template>
    </div>
    </template>

    <script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('servers_req', () => ({
            loading: true,
            data: null,
            error: null,

            init() { this.fetchDataFromServer(); },

            async fetchDataFromServer() {
                try {
                    const response = await axios.get('/api/servers');
                    this.data = response.data;
                } catch (error) {
                    this.error = 'Error fetching data';
                    console.error(error);
                } finally {
                    this.loading = false;
                }
            }
        }));
        Alpine.data('players_req', () => ({
            loading: true,
            data: null,
            error: null,

            init() { this.fetchDataFromServer(); },

            async fetchDataFromServer() {
                try {
                    const response = await axios.get('/api/players');
                    this.data = response.data;
                } catch (error) {
                    this.error = 'Error fetching data';
                    console.error(error);
                } finally {
                    this.loading = false;
                }
            }
        }));
    });
    </script>
  </body>
</html>